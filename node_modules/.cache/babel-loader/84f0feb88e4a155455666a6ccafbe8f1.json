{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar utils_1 = require(\"../utils\");\n\nfunction applyOrderBy(queries, astOrderBy) {\n  astOrderBy.forEach(function (orderBy) {\n    utils_1.assert(orderBy.expr.type === 'column_ref', 'ORDER BY only supports ordering by field names.');\n    queries = queries.map(function (query) {\n      return query.orderBy(orderBy.expr.column, orderBy.type.toLowerCase());\n    });\n  });\n  return queries;\n}\n\nexports.applyOrderBy = applyOrderBy;\n\nfunction applyOrderByLocally(docs, astOrderBy) {\n  return docs.sort(function (doc1, doc2) {\n    return astOrderBy.reduce(function (result, orderBy) {\n      if (result !== 0) {\n        // We already found a way to sort these 2 documents, so there's\n        // no need to keep going. This doesn't actually break out of the\n        // reducer but prevents doing any further unnecessary and\n        // potentially expensive comparisons.\n        return result;\n      }\n\n      var field = orderBy.expr.column;\n\n      if (doc1[field] < doc2[field]) {\n        result = -1;\n      } else if (doc1[field] > doc2[field]) {\n        result = 1;\n      } else {\n        result = 0;\n      }\n\n      if (orderBy.type === 'DESC' && result !== 0) {\n        result = -result;\n      }\n\n      return result;\n    }, 0);\n  });\n}\n\nexports.applyOrderByLocally = applyOrderByLocally;","map":{"version":3,"sources":["../../src/select/orderby.ts"],"names":[],"mappings":";;;;;;AAAA,IAAA,OAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AAEA,SAAgB,YAAhB,CACE,OADF,EAEE,UAFF,EAEmB;AAEjB,EAAA,UAAU,CAAC,OAAX,CAAmB,UAAA,OAAA,EAAO;AACxB,IAAA,OAAA,CAAA,MAAA,CACE,OAAO,CAAC,IAAR,CAAa,IAAb,KAAsB,YADxB,EAEE,iDAFF;AAKA,IAAA,OAAO,GAAG,OAAO,CAAC,GAAR,CAAY,UAAA,KAAA,EAAK;AACzB,aAAA,KAAK,CAAC,OAAN,CAAc,OAAO,CAAC,IAAR,CAAa,MAA3B,EAAmC,OAAO,CAAC,IAAR,CAAa,WAAb,EAAnC,CAAA;AAA8D,KADtD,CAAV;AAGD,GATD;AAWA,SAAO,OAAP;AACD;;AAhBD,OAAA,CAAA,YAAA,GAAA,YAAA;;AAkBA,SAAgB,mBAAhB,CACE,IADF,EAEE,UAFF,EAEmB;AAEjB,SAAO,IAAI,CAAC,IAAL,CAAU,UAAC,IAAD,EAAO,IAAP,EAAW;AAC1B,WAAO,UAAU,CAAC,MAAX,CAA0B,UAAC,MAAD,EAAS,OAAT,EAAgB;AAC/C,UAAI,MAAM,KAAK,CAAf,EAAkB;AAChB;AACA;AACA;AACA;AACA,eAAO,MAAP;AACD;;AAED,UAAM,KAAK,GAAG,OAAO,CAAC,IAAR,CAAa,MAA3B;;AAEA,UAAI,IAAI,CAAC,KAAD,CAAJ,GAAc,IAAI,CAAC,KAAD,CAAtB,EAA+B;AAC7B,QAAA,MAAM,GAAG,CAAC,CAAV;AACD,OAFD,MAEO,IAAI,IAAI,CAAC,KAAD,CAAJ,GAAc,IAAI,CAAC,KAAD,CAAtB,EAA+B;AACpC,QAAA,MAAM,GAAG,CAAT;AACD,OAFM,MAEA;AACL,QAAA,MAAM,GAAG,CAAT;AACD;;AAED,UAAI,OAAO,CAAC,IAAR,KAAiB,MAAjB,IAA2B,MAAM,KAAK,CAA1C,EAA6C;AAC3C,QAAA,MAAM,GAAG,CAAC,MAAV;AACD;;AAED,aAAO,MAAP;AACD,KAxBM,EAwBJ,CAxBI,CAAP;AAyBD,GA1BM,CAAP;AA2BD;;AA/BD,OAAA,CAAA,mBAAA,GAAA,mBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"../utils\");\nfunction applyOrderBy(queries, astOrderBy) {\n    astOrderBy.forEach(function (orderBy) {\n        utils_1.assert(orderBy.expr.type === 'column_ref', 'ORDER BY only supports ordering by field names.');\n        queries = queries.map(function (query) {\n            return query.orderBy(orderBy.expr.column, orderBy.type.toLowerCase());\n        });\n    });\n    return queries;\n}\nexports.applyOrderBy = applyOrderBy;\nfunction applyOrderByLocally(docs, astOrderBy) {\n    return docs.sort(function (doc1, doc2) {\n        return astOrderBy.reduce(function (result, orderBy) {\n            if (result !== 0) {\n                // We already found a way to sort these 2 documents, so there's\n                // no need to keep going. This doesn't actually break out of the\n                // reducer but prevents doing any further unnecessary and\n                // potentially expensive comparisons.\n                return result;\n            }\n            var field = orderBy.expr.column;\n            if (doc1[field] < doc2[field]) {\n                result = -1;\n            }\n            else if (doc1[field] > doc2[field]) {\n                result = 1;\n            }\n            else {\n                result = 0;\n            }\n            if (orderBy.type === 'DESC' && result !== 0) {\n                result = -result;\n            }\n            return result;\n        }, 0);\n    });\n}\nexports.applyOrderByLocally = applyOrderByLocally;\n//# sourceMappingURL=orderby.js.map"]},"metadata":{},"sourceType":"script"}